# configs/default_config.yaml

# ===========================
# 项目基础设置
# ===========================
project_name: "LX-ARS-optim"
version: "1.0.0"
seed: 42
device: "cuda" # or "cpu"

# ===========================
# 路径配置
# ===========================
paths:
  # 引用已有的损伤预测项目
  surrogate_project_dir: "../LX_model_injurypredict"
  # 代理模型权重文件 (确保路径正确)
  surrogate_checkpoint: "../LX_model_injurypredict/runs/InjuryPredictModel_01281059/best_val_loss.pth" 
  
  # 数据集路径
  data_input: "../LX_model_injurypredict/data/data_input.npz"
  data_labels: "../LX_model_injurypredict/data/data_labels.npz"
  preprocessors_path: "../LX_model_injurypredict/data/preprocessors.joblib"
  
  # 本项目输出
  output_dir: "./outputs"
  strategy_model_save_path: "./weights/strategy_net_v1.pth"

# ===========================
# 步骤三：策略网络 (Strategy Net) - 摊销优化
# ===========================
strategy_net:
  # 网络架构
  hidden_dims: [128, 256, 128] # MLP 隐藏层
  activation: "LeakyReLU"
  dropout: 0.1
  
  # 离线训练超参 (用于训练 Strategy Net 模仿全局最优)
  train:
    batch_size: 256
    epochs: 100
    lr: 0.001
    weight_decay: 1e-4

# ===========================
# 步骤四：在线寻优 (Online Optimization) - 局部精调
# ===========================
optimization:
  # 精调迭代参数
  refine_steps: 50         # 局部精调迭代次数 k. 若为0，则仅进行推理
  lr: 0.05                 # 梯度下降步长 (针对归一化后的参数)
  
  # 目标函数权重 (Surrogate Model 输出的加权和)
  # Minimize Loss = w_hic * HIC_norm + w_dmax * Dmax_norm + ...
  objectives:
    weight_hic: 1.0
    weight_dmax: 1.0
    weight_nij: 0.5

  # 物理约束处理
  constraints:
    use_clamp: True # 每次更新后强制截断到 [min, max]